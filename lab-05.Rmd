---
title: "Lab 05 - La Quinta is Spanish for next to Denny's, Pt. 2"
author: "Olivia Zhang"
date: "02/23/2025"
output: github_document
---

### Load packages and data

```{r load-packages, message = FALSE}
library(tidyverse) 
library(dsbox) 
```

```{r load-data, message = FALSE}
states <- read_csv("data/states.csv")
```

### Exercise 1

```{r filter-dn-ak}
dn_ak <- dennys %>%
  filter(state == "AK")
nrow(dn_ak)
```
There are `r nrow(dn_ak)` Denny’s locations in Alaska.

```{r filter-lq-ak}
lq_ak <- laquinta %>%
  filter(state == "AK")
nrow(lq_ak)
```
There are `r nrow(lq_ak)` La Quinta locations in Alaska.

### Exercise 2

```{r join}
dn_ak$establishment <- "dn"
lq_ak$establishment <- "lq"

dn_lq_ak <- 
  full_join(dn_ak, lq_ak, by = join_by(address, city, state, zip, longitude, latitude, establishment))
```

```{r dn1-distance}
#dn1
dn1_lq1 <- sqrt((dn_lq_ak$longitude[1] - dn_lq_ak$longitude[4])^2 + (dn_lq_ak$latitude[1] - dn_lq_ak$latitude[4])^2)

dn1_lq2 <- sqrt((dn_lq_ak$longitude[1] - dn_lq_ak$longitude[5])^2 + (dn_lq_ak$latitude[1] - dn_lq_ak$latitude[5])^2)

#dn2
dn2_lq1 <- sqrt((dn_lq_ak$longitude[2] - dn_lq_ak$longitude[4])^2 + (dn_lq_ak$latitude[2] - dn_lq_ak$latitude[4])^2)

dn2_lq2 <- sqrt((dn_lq_ak$longitude[2] - dn_lq_ak$longitude[5])^2 + (dn_lq_ak$latitude[2] - dn_lq_ak$latitude[5])^2)

#dn3
dn3_lq1 <- sqrt((dn_lq_ak$longitude[3] - dn_lq_ak$longitude[4])^2 + (dn_lq_ak$latitude[3] - dn_lq_ak$latitude[4])^2)

dn3_lq2 <- sqrt((dn_lq_ak$longitude[3] - dn_lq_ak$longitude[5])^2 + (dn_lq_ak$latitude[3] - dn_lq_ak$latitude[5])^2)
```
There are six pairings. 

### Exercise 3

Well, I guess I did in my own way above. I'll follow the steps now. 
```{r join-mason}
dn_lq_ak <- full_join(dn_ak, lq_ak, 
                      by = "state")
dn_lq_ak
```


### Exercise 4
There are `r nrow(dn_lq_ak)` observations in the joined dn_lq_ak data frame. The names are `r names(dn_lq_ak)`.

### Exercise 5

```{r haversine, echo=FALSE}
haversine <- function(long1, lat1, long2, lat2, round = 3) {
  # convert to radians
  long1 <- long1 * pi / 180
  lat1 <- lat1 * pi / 180
  long2 <- long2 * pi / 180
  lat2 <- lat2 * pi / 180

  R <- 6371 # Earth mean radius in km

  a <- sin((lat2 - lat1) / 2)^2 + cos(lat1) * cos(lat2) * sin((long2 - long1) / 2)^2
  d <- R * 2 * asin(sqrt(a))

  return(round(d, round)) # distance in km
}
```


### Exercise 6

```{r distance}
dn_lq_ak$distance <- haversine(dn_lq_ak$longitude.x, dn_lq_ak$latitude.x, dn_lq_ak$longitude.y, dn_lq_ak$latitude.y, round = 3)
```

### Exercise 7

```{r min-distance}
dn_lq_ak_mindist <- dn_lq_ak %>%
  group_by(address.x) %>%
  summarize(closest = min(distance))
```

### Exercise 8

```{r ak-vis}
ggplot() +
  layer(
    data = dn_lq_ak, mapping = aes(x = latitude.x, 
                                   y = longitude.x, 
                                   color = "blue"), 
    geom = "point", stat = "identity", position = "identity"
  ) + 
  layer(
    data = dn_lq_ak, mapping = aes(x = latitude.y, 
                                   y = longitude.y, 
                                   color = "orange"), 
    geom = "point", stat = "identity", position = "identity"
  )  +
  labs(
  title = "Danny's and La Quinta Locations",
  subtitle = "in Alaska",
  x = "Longitude of establishements", 
  y = "Latitude of establishements", 
  color = "Establishment"
     )
```
Describe the distribution of the distances Denny’s and the nearest La Quinta locations in Alaska. Also include an appropriate visualization and relevant summary statistics.

In Alaska, La Quinta locations are all near Denny’s. The distance between the nearest Denny's and La Quinta are `r dn_lq_ak_mindist`.










